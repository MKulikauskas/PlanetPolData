#_author_: Matas Kulikauskas

import numpy as np
import matplotlib.pyplot as plt
from scipy.interpolate import interp1d

fig = plt.figure()

plt1 = fig.add_subplot(2, 1, 2)

plt2 = fig.add_subplot(2, 1, 1)

plt.title('Figure 19.4, right side (Uranus)')
plt1.set(xlabel='Phase (deg.)', ylabel='P (%)')
plt2.set(xlabel='Wavelength (nm)', ylabel='P (90 deg.) (%)')

plt.grid(True)

xnewone = np.linspace(7.574643653, 171.9839136, num=100000, endpoint=True)
xnewtwo = np.linspace(529.8018761, 928.2068354, num=100000, endpoint=True)

f1 = interp1d([7.574643653, 15.0762073, 22.57777095, 29.45420429,
35.08037703, 40.08141946, 45.0824619, 50.08350433, 54.45941646,
58.21019828, 61.96098011, 65.71176193, 69.46254375, 73.83845588,
79.46462862, 86.71614015, 93.96765167, 101.7192674, 108.2206226,
113.8467953, 118.2227075, 121.9734893, 125.7242711, 129.4750529,
133.2258348, 136.9766166, 140.7273984, 144.4781802, 148.2289621,
152.6048742, 158.2310469, 164.48235, 171.9839136], [0.2520758123,
1.425144404, 3.104765343, 5.109646209, 6.997220217, 8.956777978,
11.07629964, 13.39577617, 15.47530686, 17.39487365, 19.15447653,
20.96740072, 22.62036101, 24.51326715, 26.51281588, 28.36839711,
29.07223827, 28.56035379, 27.05669314, 24.99315884, 23.04693141,
21.18068592, 19.31444043, 17.23490975, 15.15537906, 13.18249097,
11.15628159, 9.290036101, 7.530433213, 5.637527076, 3.60598556,
1.878375451, 0.2787364621], kind = 'cubic')

f2 = interp1d([529.8018761, 535.6069178, 542.2816077, 542.2445775,
542.3334499, 544.960124, 545.4569456, 546.688199, 548.5026778,
549.7987341, 554.4645367, 562.2408745, 564.487372, 567.1658883,
569.8228037, 574.7921564, 577.7935499, 579.6080287, 580.1264512,
584.0146201, 588.6804227, 592.4398088, 596.0682178, 598.5304505,
602.974072, 607.3436332, 610.7133796, 611.2318021, 613.5242445,
614.187359, 613.8506587, 615.7097108, 617.6613384, 623.6739424,
623.6739424, 623.6739424, 626.6404712, 629.4136202, 630.1542238,
637.6980943, 642.6482064, 647.7805893, 650.8911244, 654.4682398,
657.3714058, 660.4819409, 666.0296104, 669.9313695, 672.9240813,
673.4425038, 676.0346164, 683.5517428, 685.9888772, 691.5872918,
694.852805, 694.2479788, 697.6905387, 697.0574722, 697.9125951,
700.5441379, 702.1882093, 704.3153874, 707.0624781, 707.6583897,
712.3889952, 716.3537492, 716.7307837, 716.5092884, 716.030639,
719.7376343, 722.6926427, 726.4258334, 729.8730688, 731.9064246,
735.0572939, 735.3939943, 737.7268956, 737.7268956, 741.6150644,
741.8742757, 744.348565, 751.9835147, 755.7167054, 757.9186296,
760.0190637, 760.2782749, 764.5058871, 770.6467252, 772.3433807,
775.3643701, 778.6822742, 778.6822742, 778.5644509, 783.315883,
789.6720086, 795.8190184, 798.641541, 800.4560198, 800.9744423,
803.4487316, 806.67709, 809.5284138, 812.8981601, 814.1942164,
816.0086952, 819.1192303, 819.6376528, 824.0442442, 828.5804412,
832.3999953, 834.8570566, 834.4126945, 834.931117, 837.3279172,
838.0416521, 837.7049518, 841.0225816, 839.6236637, 844.6330241,
850.2245812, 853.2487125, 852.8166938, 856.5634747, 856.7048626,
860.1856995, 860.074609, 863.9627778, 867.0733129, 868.6285804,
869.2951237, 871.7145659, 872.3329699, 875.1088619, 878.4450068,
881.6666324, 881.111055, 881.252443, 882.36952, 891.4391711, 896.364185,
900.2523538, 903.3628889, 906.1367237, 906.8101243, 908.8587161,
910.1188394, 913.1889156, 919.4339868, 919.6931981, 922.0260994,
924.9952465, 928.2068354], [27.75301918, 37.34604965, 50.72897053,
48.21042924, 46.11044076, 35.545479, 33.69648964, 32.83403143,
25.93436575, 23.86116477, 24.05641164, 24.68648364, 26.22487799,
28.54897591, 31.4540983, 36.57597429, 32.64688929, 29.16631441,
27.75006725, 22.88398724, 23.19525036, 28.62160397, 31.44622065,
29.15905161, 25.20943012, 31.04011836, 40.17672828, 42.13042309,
53.07823848, 57.79560389, 55.34872997, 63.44041809, 67.048265,
50.44595166, 48.37643623, 46.2702225, 29.59804788, 23.77627483,
22.47242824, 22.5450563, 25.1427199, 26.93663298, 28.60707835,
32.12953925, 35.49706029, 38.18429851, 43.79971564, 38.9017757,
28.54897591, 25.80726665, 20.89920455, 27.17729458, 24.61361104,
22.35387926, 27.62296814, 24.78200054, 35.35620587, 33.65714944,
37.7727395, 46.77407966, 49.87929908, 46.85124697, 38.77500672,
36.57437651, 29.02598182, 47.09554136, 52.60338931, 50.13564923,
45.61656996, 66.88206586, 71.39226838, 76.07984894, 73.60162164,
69.3263302, 59.56115744, 57.27337355, 43.0019598, 40.9320601,
24.84494486, 22.62978903, 16.42669247, 15.5485532, 15.92840948,
17.3133382, 19.83360873, 21.56215655, 28.10089327, 28.76686009,
31.34185493, 36.41459478, 47.39595742, 45.5439419, 43.62259959,
57.48368346, 49.05809284, 60.26956923, 57.43476924, 54.42877455,
53.02463206, 48.65374337, 39.98789532, 36.27660147, 31.98428313,
29.83533797, 25.80726665, 20.43884256, 19.03470007, 15.00054148,
13.15182723, 10.9274601, 15.82869, 14.38650425, 18.96207201, 31.4937136,
35.15812935, 33.56031203, 41.02207662, 38.31744995, 34.85724167,
26.28328786, 35.01287323, 33.08822964, 48.46226939, 50.70053414,
63.17180955, 61.52211505, 66.95601443, 65.48149714, 63.5193867,
61.87487991, 54.91234677, 52.29835146, 47.32371364, 53.13876186,
64.85090113, 61.05333394, 63.19256043, 69.12456813, 68.62265199,
67.98601237, 66.68908273, 65.21162049, 56.94654729, 54.87664758,
43.61929831, 39.4443377, 42.02628444, 31.04253929, 29.49314068,
24.26392038, 16.26823125, 11.47656094], kind='cubic')

plt1.plot(xnewone, f1(xnewone))
plt2.plot(xnewtwo, f2(xnewtwo))

plt.show()
