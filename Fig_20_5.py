#_author_: Matas Kulikauskas


#imports:
import numpy as np
import matplotlib.pyplot as plt
from scipy.interpolate import interp1d

fig = plt.figure()

plt1 = fig.add_subplot(2, 1, 2)
plt2 = fig.add_subplot(2, 1, 1)

plt.title('Figure 20.5 (Europa)')
plt1.set(xlabel='Phase angle (deg.)', ylabel='Polarization (%)')
plt2.set(ylabel='Relative intensity')

plt1.errorbar(x=[0.09371766126, 0.1241268541, 0.1798141601, 0.2111288375,
0.211807951, 0.264703346, 0.2802474991, 0.3486115902, 0.5325004312,
0.59912901, 0.614446792, 0.7673982408, 0.9008817696, 1.404934891,
1.440248793, 1.622628493, 2.127738013, 2.211344429, 2.633073905,
3.272421525, 3.455555795, 3.911316402, 4.350627372, 4.973148068,
6.284289841], y=[-0.2556053812, -0.1013452915, -0.3488789238,
-0.2376681614, -0.269955157, -0.3847533632, -0.3237668161,
-0.3739910314, -0.3165919283, -0.2843049327, -0.2125560538,
-0.2843049327, -0.2304932735, -0.1946188341, -0.2735426009,
-0.1443946188, -0.1587443946, -0.133632287, -0.1838565022,
-0.1802690583, -0.0869955157, -0.1551569507, -0.2412556054,
-0.2376681614, -0.1730941704], yerr=[0.039461883442152,
0.057399103159192, 0.021524663710313, 0.02511210758834,
0.017937219780268, 0.028699551540806, 0.032286995525559,
0.014349775741255, 0.021524663726008, 0.014349775749327,
0.017937219719282, 0.02869955153408, 0.032286995473093,
0.028699551588789, 0.01793721973408, 0.035874439427802,
0.021524663658295, 0.017937219735425, 0.032286995473542,
0.035874439465919, 0.02511210762825, 0.039461883435425,
0.043049327373093, 0.035874439426905, 0.039461883404484], fmt='o',
capsize=5)

plt1.errorbar(x=[0.1926418593, 0.2614586927, 0.5315949465, 0.3463478786,
0.38037901, 0.4649663677, 0.4155419972, 0.7654363574, 0.6977513798,
0.7494394619, 0.749590376, 0.6486288375, 0.9521925664, 1.35528415,
1.571845895, 1.842057606, 2.129171697, 4.769564936, 6.081838565,
0.5150321231], y=[-0.1587443946, -0.2304932735, -0.2735426009,
-0.266367713, -0.2843049327, -0.3058295964, -0.3560538117,
-0.1910313901, -0.1730941704, -0.2304932735, -0.2376681614,
-0.2376681614, -0.269955157, -0.2340807175, -0.130044843, -0.1766816143,
-0.2269058296, -0.1587443946, -0.1479820628, -0.2860986547],
yerr=[0.017937219712108, 0.032286995473094, 0, 0, 0.035874439426458, 0,
0, 0, 0.039461883404485, 0, 0.089686098619731,
0.025112107588341, 0.0394618834574, 0.0466367713116, 0.041255605331838,
0.021524663627355, 0.025112107626906, 0.039461883389238,
0.039461883427803, 0], fmt='o', capsize=5)

xnewone = np.linspace(0.03850504699, 11.83289462, num=100000,
endpoint=True)

f1 = interp1d([0.03850504699, 0.1830947616, 0.3247336657, 0.6168639053,
1.009321702, 1.463746519, 1.918171337, 2.372596154, 2.827020971,
3.269052384, 3.735870606, 4.190295423, 4.636457971, 5.099145057,
5.553569875, 6.007994692, 6.462419509, 6.916844326, 7.371269144,
7.829825096, 8.280118778, 8.734543596, 9.188968413, 9.64339323,
10.09781805, 10.55224286, 11.00666768, 11.45283023, 11.83289462],
[1.023585134, 0.99597641, 0.9654930549, 0.9388166834, 0.9183419177,
0.9077889307, 0.9021160152, 0.8949755924, 0.8905958958, 0.8869184972,
0.8824221112, 0.8787012243, 0.8747722975, 0.8699000019, 0.8667019798,
0.8624582281, 0.858353907, 0.8544935894, 0.8512955673, 0.8468525739,
0.8435400745, 0.8397146146, 0.8358891547, 0.8333185704, 0.8293885375,
0.8249879263, 0.8196461585, 0.8148492762, 0.812842883], kind='cubic')

plt2.plot(xnewone, f1(xnewone))

plt2.plot([0.2884615385, 0.4903846154, 0.5192307692, 1.009615385,
1.961538462, 2.163461538, 2.278846154, 2.567307692, 2.596153846,
3.980769231, 3.490384615, 3.490384615, 2.798076923, 2.740384615,
2.942307692, 3.028846154, 3.173076923, 3.115384615, 4.384615385,
4.788461538, 4.269230769, 5.798076923, 6.403846154, 6.980769231,
6.980769231, 6.980769231, 7.384615385, 7.528846154, 7.471153846,
7.586538462, 8.105769231, 8.509615385, 8.711538462, 8.509615385,
8.798076923, 9.519230769, 9.490384615, 9.692307692, 9.692307692,
9.894230769, 10.18269231, 10.61538462, 10.78846154, 11.10576923,
11.33653846, 11.42307692, 11.10576923, 11.10576923, 10.90384615],
[1.002008032, 0.9666666667, 0.9570281124, 0.9200803213, 0.9088353414,
0.9168674699, 0.9136546185, 0.921686747, 0.9120481928, 0.9088353414,
0.9024096386, 0.8975903614, 0.9008032129, 0.89437751, 0.9024096386,
0.8927710843, 0.90562249, 0.8991967871, 0.8831325301, 0.8863453815,
0.8847389558, 0.8767068273, 0.8718875502, 0.862248996, 0.8558232932,
0.846184739, 0.862248996, 0.8558232932, 0.8493975904, 0.8445783133,
0.8510040161, 0.8413654618, 0.8493975904, 0.8542168675, 0.8365461847,
0.8413654618, 0.8317269076, 0.8285140562, 0.834939759, 0.8333333333,
0.8317269076, 0.8317269076, 0.8269076305, 0.8317269076, 0.8236947791,
0.8124497992, 0.8220883534, 0.8124497992, 0.8108433735], 'o')

plt2.plot([0.1730769231, 0.2019230769, 0.2019230769, 0.3173076923,
0.375, 0.5769230769, 0.8076923077, 1.096153846, 1.298076923,
1.298076923, 1.384615385, 1.701923077, 1.875, 1.759615385, 2.076923077,
2.019230769, 2.625, 2.596153846, 2.682692308, 3.086538462, 3.173076923,
3.259615385, 3.605769231, 3.605769231, 3.288461538, 3.894230769,
3.894230769, 4.182692308, 4.701923077, 4.615384615, 4.903846154,
5.192307692, 5.307692308, 5.394230769, 5.567307692, 5.596153846,
5.826923077, 5.971153846, 6.173076923, 6.375, 6.576923077, 6.576923077,
6.692307692, 7.384615385, 7.788461538, 7.990384615, 8.192307692,
8.365384615, 8.307692308, 8.509615385, 8.826923077, 9.086538462,
8.971153846, 9.201923077, 9.317307692, 9.605769231, 9.807692308,
10.00961538, 10.32692308, 10.29807692, 10.5, 11.10576923, 11.30769231,
10.90384615, 10.90384615], [1.003614458, 0.9891566265, 0.9827309237,
0.9682730924, 0.9602409639, 0.9457831325, 0.9168674699, 0.921686747,
0.9136546185, 0.9040160643, 0.9104417671, 0.9120481928, 0.9008032129,
0.9024096386, 0.9024096386, 0.8975903614, 0.8991967871, 0.8927710843,
0.8815261044, 0.8863453815, 0.89437751, 0.9008032129, 0.8927710843,
0.8879518072, 0.8734939759, 0.8831325301, 0.8767068273, 0.8815261044,
0.8767068273, 0.8686746988, 0.8718875502, 0.8686746988, 0.8702811245,
0.8654618474, 0.8638554217, 0.8702811245, 0.862248996, 0.8654618474,
0.8638554217, 0.8558232932, 0.8638554217, 0.8526104418, 0.8526104418,
0.8413654618, 0.8477911647, 0.8381526104, 0.8477911647, 0.8413654618,
0.8365461847, 0.834939759, 0.8317269076, 0.8526104418, 0.8413654618,
0.8413654618, 0.8317269076, 0.8253012048, 0.8397590361, 0.834939759,
0.8317269076, 0.8220883534, 0.8172690763, 0.8333333333, 0.8301204819,
0.8156626506, 0.8220883534], 'o')

plt.show()

