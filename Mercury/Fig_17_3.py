#_author_: Matas Kulikauskas


#imports:
import numpy as np
import matplotlib.pyplot as plt
from scipy.interpolate import interp1d

plt.axis([0, 140, -3, 15])

plt.title('Figure 17.3 (Mercury)')
plt.xlabel('Phase angle (deg.)')
plt.ylabel('Polarization (%)')

plt.grid(True)


#350nm

xnewone = np.linspace(8.354716981, 22.830188679245282, num=100000,
endpoint=True)
xnewtwo = np.linspace(23.396226415094347, 80.29433962,
num=100000, endpoint=True)

f350a = interp1d([8.354716981, 11.36603774, 13.40377358, 15.8490566,
17.88679245, 20.33207547, 22.33962264, 22.830188679245282], [1.19978903,
1.851814346, 2.30371308, 2.768523207, 3.194599156, 3.685232068,
4.100548523, 4.190928270042189], kind='cubic')

f350b = interp1d([23.396226415094347, 28.23396226, 31.74339623,
35.38113208, 40.18113208, 48.04528302, 52.39245283, 55.38113208,
59.45660377, 61.90188679, 68.21886792, 80.29433962], [4.280590717299578,
5.29592827, 5.983459916, 6.693586498, 7.629662447, 9.082194093,
9.805232068, 10.28295359, 10.82523207, 11.09637131, 11.67738397,
12.05611814], kind='cubic')

plt.plot(xnewone, f350a(xnewone), ':')
plt.plot(xnewtwo, f350b(xnewtwo))

plt.plot([25.66037736, 25.66037736, 33.96226415, 38.49056604,
50.56603774, 76.60377358, 80.37735849], [4.101265823, 5.141350211,
6.898734177, 7.687763713, 8.978902954, 12.06329114, 11.84810127], 'o')

plt.plot([83.0188679245283], [12.206751054852319], 'x')

#380nm

xnewthree = np.linspace(10.113207547, 23.154716981, num=100000, endpoint=True)
xnewfour = np.linspace(25.2623622, 78.36472441, num=100000, endpoint=True)

f380a = interp1d([9.433700787, 13.20566929, 15.65480315, 18.10393701,
20.55307087, 23.56913386], [0.9451476793, 1.696877637, 2.174599156,
2.652320675, 3.117130802, 3.684514768], kind='cubic')

f380b = interp1d([25.2623622, 28.71685039, 31.16598425, 33.61511811,
36.60850394, 40.14614173, 42.59527559, 45.04440945, 47.49354331,
50.75905512, 54.43275591, 58.10645669, 62.59653543, 67.49480315,
72.39307087, 78.36472441], [3.973012658, 4.705232068, 5.170042194,
5.673586498, 6.306244726, 6.977637131, 7.429535865, 7.881434599,
8.307510549, 8.834295359, 9.353333333, 9.849130802, 10.32168776,
10.75421941, 11.03827004, 11.15590717], kind='cubic')

plt.plot(xnewthree, f380a(xnewthree), ':')
plt.plot(xnewfour, f380b(xnewfour))

plt.plot([24.37795276, 38.74015748, 33.82677165, 50.45669291,
77.29133858, 81.4488189], [3.85021097, 5.930379747, 6.46835443,
8.727848101, 11.74050633, 11.2742616], 'o')

plt.plot([83.84172461198224], [10.930306230200634], 'x')

#435nm

xnewfive = np.linspace(6.322352613, 15.59266004, num=100000, endpoint=True)
xnewsix = np.linspace(15.8354446, 89.78812935, num=100000, endpoint=True)

f435a = interp1d([6.322352613, 10.34560778, 12.79533781, 15.59266004],
[0.2039704329, 0.9392608237, 1.339936642, 1.778669483], kind='cubic')

f435b = interp1d([15.8354446, 21.77858979, 26.1108645, 29.945026,
32.93944333, 35.93386065, 38.5198701, 42.46666534, 45.46065231,
48.72619394, 52.53584906, 56.48077942, 67.0062553, 81.52136279,
89.78812935], [1.893558606, 2.89093981, 3.588891235, 4.286842661,
4.803843717, 5.320844773, 5.760295671, 6.40654699, 6.884772967,
7.350073918, 7.88, 8.358225977, 9.327602957, 9.906787751, 9.870454065],
kind='cubic')

plt.plot(xnewfive, f435a(xnewfive), ':')
plt.plot(xnewsix, f435b(xnewsix))

plt.plot([25.5438226, 35.3794505, 50.86230599, 74.67613716, 81.08844215,
86.74603016], [3.498416051, 5.688489968, 6.693769799, 10.31995776,
10.0686378, 9.817317846], 'o')

plt.plot([82.97204678129526], [9.78141499472017], 'x')

#520nm

xnewseven = np.linspace(0.1778804965, 21.92896734, num=100000, endpoint=True)
xneweight = np.linspace(22.59443326, 129.4097906, num=100000, endpoint=True)

f520a = interp1d([0.1778804965, 2.993118288, 6.247757566, 10.04851866,
15.62019486, 19.29141878, 21.92896734], [0.107032735, -0.5600422386,
-1.077043295, -1.348468849, -1.180443506, -0.8831678986, -0.5600422386],
kind='cubic')

f520b = interp1d([22.59443326, 28.27200255, 32.76192146, 36.02757068,
39.70205814, 43.37507521, 46.64111893, 49.90698332, 53.17263254,
56.03019665, 59.1071722, 63.00004861, 67.08157239, 70.94266303,
75.2114921, 80.10650515, 84.91836226, 89.8926182, 94.78465063,
99.67561515, 105.3815066, 110.2708374, 115.1593234, 120.0464466,
123.5227272, 126.5604949, 129.4097906], [-0.44156283, 0.4274297782,
1.049123548, 1.524118268, 2.115438226, 2.574276663, 3.084815206,
3.579197466, 4.054192186, 4.480718057, 4.956215417, 5.504380148,
6.04967265, 6.453938754, 6.875438226, 7.276114044, 7.528439282,
7.724899683, 7.857022175, 7.892925026, 7.91374868, 7.802449842,
7.615036959, 7.304836325, 7.037719113, 6.700591341, 6.382133052],
kind='cubic')

plt.plot(xnewseven, f520a(xnewseven), ':')
plt.plot(xneweight, f520b(xneweight))

plt.plot([22.48152059, 27.7745014, 30.41800323, 39.11318762,
44.77834672, 48.93686119, 61.0318583, 65.9442928, 72.36855213,
76.52387878, 81.43352394, 86.34237214, 123.318324, 129.3496842],
[-0.4149947202, 0.4825765576, 0.6620908131, 2.098204857, 2.529039071,
3.211193242, 4.970432946, 5.580781415, 6.40654699, 6.801478353,
7.160506864, 7.447729673, 6.980992608, 6.40654699], 'o')

plt.plot([46.2909685, 69.34689486, 99.55310713], [2.81626188, 6.155227033,
7.734952482], 'o')

plt.plot([56.87653164910034], [4.575501583949313], '+')

plt.plot([95.0279930664858], [8.022175290390708], 's')

plt.plot([103.70763682731939], [8.058078141499472], 'x')

#580

xnewnine = np.linspace(0.4754716981, 129.4641509, num=100000, endpoint=True)

f580 = interp1d([0.05283018868, 1.494339623, 5.162264151, 9.971320755,
14.94339623, 19.01886792, 23.25283019, 26.35471698, 30.02264151,
33.69056604, 37.2, 40.43018868, 42.62641509, 46.3245283, 49.58490566,
52.84528302, 56.67169811, 59.14716981, 62.95245283, 67.10943396,
71.59245283, 76.0754717, 80.77735849, 85.85660377, 90.74716981,
95.63773585, 100.6354717, 105.6633962, 110.309434, 115.2, 120.090566,
124.9811321, 130.5660377], [-0.0889968321, -0.5535797254, -1.113664203,
-1.335543823, -1.14813094, -0.8605491024, -0.2927526927, 0.1282154171,
0.6394002112, 1.220380148, 1.747074974, 2.192988384, 2.552734952,
3.114973601, 3.578551214, 3.989567054, 4.535003168, 4.878162619,
5.426829989, 5.80876452, 6.272126716, 6.613347413, 6.916008448,
7.136810982, 7.291911299, 7.311298838, 7.306846885, 7.249258712,
7.07218585, 6.801478353, 6.480506864, 6.070496304, 5.435374868],
kind='cubic')

plt.plot(xnewnine, f580(xnewnine))

plt.plot([0.7547169811, 0.3773584906, 5.660377358, 4.150943396,
6.41509434, 9.056603774, 9.056603774, 12.0754717, 12.0754717,
14.71698113, 16.22641509, 16.98113208, 20.37735849, 19.62264151,
21.13207547, 23.39622642, 21.88679245, 24.1509434, 30.18838304552591012,
32.0754717, 35.8490566, 38.11320755, 34.33962264, 38.11320755,
38.11320755, 43.01886792, 42.26415094, 40, 46.41509434, 47.9245283,
50.56603774, 58.49056604, 54.71698113, 58.49056604, 61.50943396,
61.88679245, 70.56603774, 73.58490566, 82.64150943, 83.39622642,
95.8490566, 99.24528302, 106.4150943, 113.9622642, 113.9622642,
116.6037736, 118.1132075, 119.6226415, 129.8113208, 101.509434,
101.1320755], [-0.2354804646, -0.4868004224, -1.025343189, -1.025343189,
-1.312565998, -1.3843717, -1.563885956, -1.456177402, -1.312565998,
-1.276663147, -0.9535374868, -1.06124604, -0.9894403379, -0.8458289335,
-0.5945089757, -0.4508975713, -0.3072861668, -0.1995776135,
0.23125659978880897, 0.7338965153, 1.092925026, 1.272439282,
1.380147835, 1.667370644, 2.062302006, 2.313621964, 2.672650475,
2.744456177, 2.959873284, 3.426610348, 3.713833157, 4.575501584,
4.683210137, 4.898627244, 5.293558606, 5.508975713, 6.047518479,
6.550158395, 6.837381204, 7.124604013, 7.160506864, 7.447729673,
6.980992608, 7.124604013, 7.088701162, 6.909186906, 6.298838437,
6.047518479, 5.401267159, 7.088701162, 7.088701162], '+')

plt.plot([44.90566037735826], [2.457233368532208], 'o')

plt.plot([102.64150943396157], [7.48363252375924], 'x')

#630nm

xnewten = np.linspace(0.210989011, 25.25086342, num=100000, endpoint=True)
xneweleven = np.linspace(25.73635344, 129.0499215, num=100000, endpoint=True)

f630a = interp1d([0.210989011, 1.273469388, 4.498587127, 8.432025118,
13.45054945, 17.92653061, 22.80941915, 25.25086342], [0.1034424498,
-0.3015417107, -0.9671805702, -1.296768743, -1.277381204, -0.9865681098,
-0.4359619852, -0.09761351637], kind='cubic')

f630b = interp1d([25.73635344, 31.76138148, 35.39340659, 38.67880691,
41.93406593, 45.78461538, 50.0722135, 54.14128728, 57.81852433,
62.68634223, 67.16232339, 72.04521193, 76.92810047, 81.81098901,
86.69387755, 91.57676609, 96.45965463, 101.3425432, 107.0392465,
111.922135, 116.8050235, 121.6879121, 129.0499215], [-0.06191582441,
0.7798521647, 1.262386484, 1.727687434, 2.163907075, 2.678969377,
3.272228089, 3.734297782, 4.170517423, 4.713368532, 5.178669483,
5.631045407, 6.028848997, 6.316071806, 6.522872228, 6.697360084,
6.833072862, 6.936473073, 6.923548046, 6.871847941, 6.716747624,
6.516409715, 6.048523759], kind='cubic')

plt.plot(xnewten, f630a(xnewten), ':')
plt.plot(xneweleven, f630b(xneweleven))

plt.plot([22.41758242, 24.67817896, 27.3155416, 30.32967033,
32.96703297, 45.02354788, 48.79120879, 57.08006279, 60.47095761,
66.87598116, 72.15070644, 76.67189953, 81.9466248, 124.5211931,
129.7959184], [-0.2713833157, 0.08764519535, 0.3389651531, 0.626187962,
1.272439282, 2.852164731, 3.175290391, 4.144667371, 4.360084477,
4.862724393, 5.293558606, 5.832101373, 6.478352693, 6.478352693,
6.083421331], 'o')

plt.plot([103.045525902668], [6.945089757127772], 'x')


plt.axhline(color='k')

plt.show()
